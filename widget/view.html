<!-- Copyright start
  MIT License
  Copyright (c) 2024 Fortinet Inc
  Copyright end -->

<link rel="stylesheet" type="text/css" href="{{widgetCSS}}" />
<link rel="stylesheet" type="text/css" href="{{themeCSS}}" />
<div class="modal-header">
    <h3 class="modal-title col-md-9">{{viewWidgetVars.LABEL_TITLE}}</h3>
</div>
<wizard on-finish="close()" indicators-position="top" class="cs-wizard ingestion-steps ioc-extraction-config-steps"
    name="configureIndicatorExtraction">
    <wz-step wz-title="{{viewWidgetVars.START_PAGE_WZ_TITLE}}" wz-order="1"
        class="ingestion-modal-padding wizard-first-step">
        <div class="full-width full-height dashboard-height padding-bottom-md solutionpack-wizard-modal-body">
            <div class="full-height overflow-auto">
                <div class="display-table fixed-table-layout full-height full-width">
                    <div class="full-height display-table-cell vertical-align-middle">
                        <div class="col-md-6 display-flex align-items-center margin-top-34 padding-0">
                            <div class="full-width">
                                <img class="img-responsive d-info-image" src="{{pageImages.startPageImage}}">
                            </div>
                        </div>
                        <div class="col-md-6 prerequisites-section padding-bottom-25 padding-left-0">
                            <div class="font-size-40 line-height-1">{{viewWidgetVars.START_PAGE_TITLE}}</div><br />
                            <div class="margin-top-sm padding-right-30" style="max-width: 650px;">
                                <p class="font-size-14 margin-bottom-0">{{viewWidgetVars.START_PAGE_DESCRIPTION}}</p>
                            </div>
                        </div>
                        <button type="button"
                            class="btn btn-primary btn-sm margin-top-xlg text-transform-none font-size-14"
                            data-ng-click="moveNext()" id="solutionpack-next-btn">{{viewWidgetVars.START_PAGE_BUTTON}}<i
                                class="fa fa-chevron-right margin-left-sm"></i></button>
                    </div>
                </div>
            </div>
        </div>
    </wz-step>
    <wz-step wz-title="{{viewWidgetVars.EXCLUDELIST_CONFIG_PAGE_WZ_TITLE}}" wz-order="2"
        class="ingestion-modal-padding">
        <div class="full-width wz-step-height padding-bottom-md solutionpack-wizard-modal-body">
            <div class="full-height overflow-auto">
                <div class="display-table fixed-table-layout full-height full-width">
                    <div class="full-height display-table-cell vertical-align-middle">
                        <div class="col-md-5 full-height padding-bottom-md"
                            style="padding-left: 5%; padding-top: 200px;">
                            <div class="full-width">
                                <img class="img-responsive d-info-image" src="{{pageImages.excludeIOCPageImage}}">
                            </div>
                        </div>
                        <div class="col-md-7 config-section">
                            <div class="padding-20">
                                <div class="font-size-25">{{viewWidgetVars.EXCLUDELIST_CONFIG_PAGE_TITLE}}</div>
                                <div class="padding-right-30 margin-top-sm max-width-450px">
                                    <p class="font-size-14 grey-text margin-bottom-0 z-index-0">
                                        {{viewWidgetVars.EXCLUDELIST_CONFIG_PAGE_DESCRIPTION}}</p>
                                </div>

                                <!-- Search Div START -->
                                <div class="margin-top-md position-relative filterSearch">
                                    <span
                                        class="font-075em icon icon-search margin-left-md margin-top-11 position-absolute right-10"
                                        data-ng-click="setSearchStatus('on')"
                                        data-ng-if="searchStatus === 'off'"></span>
                                    <span class="icon icon-close margin-top-md position-absolute right-10"
                                        data-ng-click="setSearchStatus('off')"
                                        data-ng-if="searchStatus === 'on'"></span>
                                    <input id="search" type="text" class="form-control padding-right-30"
                                        placeholder="{{viewWidgetVars.EXCLUDELIST_CONFIG_PAGE_SEARCH_PLACEHOLDER}}"
                                        aria-labelledby="search-btn" data-ng-model="searchString.searchText"
                                        aria-invalid="false"
                                        data-ng-change="updateSearchQuery(searchString.searchText)">
                                </div>
                                <div data-ng-if="searchStatus === 'on'">
                                    <div class="margin-bottom-lg margin-top-12">
                                        <span
                                            class="control-label font-size-12">{{viewWidgetVars.EXCLUDELIST_CONFIG_PAGE_SEARCH_RESULT_LABEL}}
                                            {{searchResultCount}} Found</span>
                                    </div>
                                    <div data-ng-repeat="(keyStoreName, filteredDetails) in globalSearchList"
                                        class="excluded-ui-select">
                                        <div class="padding-bottom-md">
                                            <label class="control-label text-transform-none">{{filteredDetails.type}}:
                                                <span
                                                    data-uib-tooltip="Search results for the {{filteredDetails.type}} entered in the search box."
                                                    data-tooltip-placement="top-left"
                                                    data-tooltip-append-to-body="true"><i class="icon icon-information"
                                                        aria-hidden="true"></i></span>
                                            </label>
                                            <div class="cs-select padding-left-3">
                                                <ui-select name="{{keyStoreName}}"
                                                    data-ng-model="filteredDetails.filteredValues" multiple
                                                    class="custom-multi-select" tagging tagging-label="false"
                                                    search-enabled="false" style="max-height: 90px;overflow-y: auto;">
                                                    <ui-select-match
                                                        ui-lock-choice="$item.length > 0">{{$item}}</ui-select-match>
                                                    <ui-select-choices
                                                        repeat="option in filteredDetails.filteredValues | filter:$select.search"
                                                        refresh-delay="0" show="($select.search.length > 0)">
                                                        <div ng-bind="option"></div>
                                                    </ui-select-choices>
                                                </ui-select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- Search Div END -->

                                <!-- Excluded IOCs List Div START -->
                                <div data-ng-if="searchStatus === 'off'">
                                    <div class="font-size-12 margin-bottom-lg margin-top-12">

                                        <!-- Bulk Import ON BUTTON -->
                                        <span
                                            class="control-label font-size-14 italic">{{viewWidgetVars.EXCLUDELIST_CONFIG_PAGE_BULK_IMPORT_LABEL}}</span>
                                        <button type="button"
                                            class="btn-link text-decoration-none font-light italic font-size-14"
                                            style="margin-left: -6px !important;"
                                            data-ng-click="setBulkImportFlags('bulkImportEnable')"
                                            id="indicator-bulk-import-button" aria-hidden="false">
                                            <span
                                                class="icon icon-import"></span>&nbsp;{{viewWidgetVars.EXCLUDELIST_CONFIG_PAGE_BULK_IMPORT_LAUNCH_BUTTON}}
                                        </button>

                                        <!-- Add New Indicator BUTTON -->
                                        <button type="button"
                                            class="btn-link text-decoration-none font-light pull-right italic font-size-14"
                                            data-ng-click="setAddNewIOCFlags('addNewIOCTypeEnabled')"
                                            id="add-new-indicator-type" aria-hidden="false"
                                            data-ng-disabled="addNewIndicatorTypeInProcess">{{viewWidgetVars.EXCLUDELIST_CONFIG_PAGE_ADD_IOC_TYPE_LAUNCH_BUTTON}}
                                        </button>
                                    </div>

                                    <!-- Bulk Import Div START -->
                                    <div id="bulk-import-container" data-ng-show="bulkImportEnable"
                                        class="bulk-import-container-background">
                                        <label class="control-label display-block manual-input-list-container"
                                            style="padding: 10px 20px;">
                                            <span
                                                class="padding-top-lg font-size-16">{{viewWidgetVars.EXCLUDELIST_CONFIG_PAGE_BULK_IMPORT_UPLOADER_LABEL}}</span>
                                        </label>
                                        <div id="upload-a-file" class="margin-top-md">
                                            <div class="file-upload bulk-import-file-upload"
                                                data-ng-model="uploadedFile" name="uploadFileDiv"
                                                ngf-select="uploadFiles(uploadedFile)"
                                                data-ngf-drop="uploadFiles(uploadedFile)"
                                                data-accept="{{supportedFileTypes}}"
                                                data-ngf-pattern="'{{supportedFileTypes}}'"
                                                data-ng-show="!uploadedFileFlag && !loadingJob">
                                                <h2 class="margin-0">
                                                    <span class="padding-right-sm fa fa-folder-open"></span>
                                                </h2>
                                                <h5 class="margin-top-sm margin-bottom-0 padding-0"
                                                    style="background-color: unset; text-align: center;">
                                                    {{viewWidgetVars.EXCLUDELIST_CONFIG_PAGE_BULK_IMPORT_DROP_A_FILE}}
                                                </h5>
                                                <div>
                                                    {{viewWidgetVars.EXCLUDELIST_CONFIG_PAGE_BULK_IMPORT_USE_STANDARD_UPLOADER}}
                                                </div>
                                                <div>
                                                    {{viewWidgetVars.EXCLUDELIST_CONFIG_PAGE_BULK_IMPORT_FILE_SIZE_SHOULD_NOT_EXCEED_25MB}}
                                                </div>
                                            </div>
                                            <div class="file-upload bulk-import-file-upload"
                                                data-ng-show="uploadedFileFlag || enableSpinner">
                                                <div data-ng-if="enableSpinner">
                                                    <cs-spinner></cs-spinner>
                                                </div>
                                                <div class="file-attachment" data-ng-show="!enableSpinner">
                                                    <div class="width-min-content position-relative">
                                                        <div class="file-attachment-icon">
                                                            <i class="fa fa-5x fa-file-o" aria-hidden="false"></i>
                                                        </div>
                                                        <span class="file-attachment-actions">
                                                            <span
                                                                class="icon icon-close btn btn-danger comment-file-remove"
                                                                data-ng-click="setBulkImportFlags('resetFileUpload')"
                                                                title="Delete" role="button" tabindex="0">
                                                            </span>
                                                        </span>
                                                    </div>
                                                </div>
                                                <div>{{ fileName }}</div>
                                            </div>
                                        </div>
                                        <div class="modal-footer bulk-import-footer">
                                            <div>
                                                <input type="checkbox"
                                                    class="margin-left-lg margin-left-sm margin-right-md pull-left"
                                                    name="select-defanging" id="select-defanging"
                                                    data-ng-model="extractDefangedIOCsFlag"
                                                    data-ng-change="updateDefangSelection(extractDefangedIOCsFlag)">
                                                </input>
                                                <label for="select-defanging"
                                                    class="control-label font-size-12 margin-top-2 pull-left">{{viewWidgetVars.EXCLUDELIST_CONFIG_PAGE_BULK_IMPORT_EXTRACT_DEFANGED_IOC}}</label>
                                            </div>
                                            <button type="submit" class="btn btn-primary btn-sm"
                                                data-ng-disabled="!uploadedFileFlag" id="upload-bulk-import-file"
                                                data-ng-click="importIOCsFromFile()">
                                                <i class="icon icon-import margin-right-sm"
                                                    data-ng-show="!bulkImportInProgress"></i><i
                                                    class="icon margin-right-sm"
                                                    data-ng-class="{'fa fa-spin icon-refresh': bulkImportInProgress}"></i>{{viewWidgetVars.EXCLUDELIST_CONFIG_PAGE_BULK_IMPORT_FILE_IMPORT_BUTTON}}
                                            </button>
                                            <button type="button" class="btn btn-second-primary btn-sm"
                                                data-ng-click="setBulkImportFlags('bulkImportDisable')"
                                                id="cancel-bulk-import"><i
                                                    class="icon icon-close margin-right-sm"></i>{{viewWidgetVars.CANCEL_BUTTON}}
                                            </button>
                                        </div>
                                    </div>
                                    <!-- Bulk Import Div END -->

                                    <!-- Add New IOC Div START -->
                                    <div id="add-new-indicator-type-container"
                                        data-ng-show="addNewIndicatorTypeInProcess"
                                        class="bulk-import-container-background margin-bottom-22">
                                        <label class="control-label display-block manual-input-list-container"
                                            style="padding: 10px 20px;">
                                            <span
                                                class="padding-top-lg font-size-16">{{viewWidgetVars.EXCLUDELIST_CONFIG_PAGE_ADD_IOC_TYPE_FORM_LABEL}}</span>
                                        </label>
                                        <div id="add-indicator-type" class="margin-top-md">
                                            <div class="add-indicator-type-form">
                                                <form data-ng-submit="submit()" id="submit-indicator-type-form"
                                                    class="noMargin" name="submitIndicatorTypeForm"
                                                    data-ng-class="{'state-wait': processing }">
                                                    <div class="margin-bottom-md" id="selectIOCType">
                                                        <select name="indicatorType" id="indicatorType"
                                                            class="form-control border-radius-5 width-35"
                                                            data-ng-model="selectedIndicatorType.dropDownValue"
                                                            data-ng-change="indicatorTypeChanged(selectedIndicatorType.dropDownValue)">
                                                            <option value="" disabled selected>
                                                                {{viewWidgetVars.EXCLUDELIST_CONFIG_PAGE_ADD_IOC_TYPE_SELECT_INDICATOR_LABEL}}
                                                            </option>
                                                            <option ng-repeat="item in notYetEnteredIOCTypes"
                                                                value="{{item}}">{{item}}</option>
                                                            <option value="+ Add Custom Indicator Type">+ Add Custom
                                                                Indicator Type</option>
                                                        </select>
                                                    </div>
                                                    <div class="margin-bottom-md">
                                                        <input id="enterIndicatorName"
                                                            data-ng-disabled="!addCustomIOCType"
                                                            class="form-control border-radius-5 width-35" type="text"
                                                            ng-model="selectedIndicatorType.iocType"
                                                            name="enterIndicatorName"
                                                            placeholder="{{viewWidgetVars.EXCLUDELIST_CONFIG_PAGE_ADD_IOC_TYPE_ENTER_IOC_PLACEHOLDER}}"
                                                            data-ng-class="{'has-error': duplicateIOCTypeFlag}" required
                                                            data-ng-change="clearDuplicateIOCErrorMsg()">
                                                        <span class="font-075em text-danger"
                                                            data-ng-if="duplicateIOCTypeFlag">{{duplicateIOCErrorMsg}}
                                                        </span>
                                                    </div>
                                                    <div>
                                                        <input data-ng-disabled="isRegexAvailable"
                                                            class="form-control border-radius-5" type="text"
                                                            ng-model="selectedIndicatorType.pattern"
                                                            name="enterRegexPattern"
                                                            placeholder="{{viewWidgetVars.EXCLUDELIST_CONFIG_PAGE_ADD_IOC_TYPE_ENTER_REGEX_PLACEHOLDER}}"
                                                            id="enterRegexPattern">
                                                    </div>
                                                </form>
                                            </div>
                                        </div>
                                        <div class="modal-footer bulk-import-footer">
                                            <button type="submit" class="btn btn-primary btn-sm"
                                                data-ng-disabled="!iocTypeSelected" id="add-new-ioc-button"
                                                data-ng-click="saveNewIOCType(selectedIndicatorType.iocType)">
                                                <i
                                                    class="icon icon-check margin-right-sm"></i>{{viewWidgetVars.SUBMIT_BUTTON}}
                                            </button>
                                            <button type="button" class="btn btn-second-primary btn-sm"
                                                data-ng-click="setAddNewIOCFlags('addNewIOCTypeDisabled')"
                                                id="cancel-bulk-import"><i
                                                    class="icon icon-close margin-right-sm"></i>{{viewWidgetVars.CANCEL_BUTTON}}
                                            </button>
                                        </div>
                                    </div>
                                    <!-- Add New IOC Div END -->

                                    <!-- UI-SELECT Excluded List Div START -->
                                    <div data-ng-repeat="(indicatorType, exclusionDetails) in updatedExclusionSettings.recordValue"
                                        class="excluded-ui-select" data-ng-show="!bulkImportEnable">

                                        <div class="padding-bottom-xlg">

                                            <div>
                                                <label
                                                    class="control-label text-transform-none font-primary-color">{{indicatorType}}:
                                                    <span
                                                        data-uib-tooltip="Specify {{indicatorType}} to exclude from enrichment."
                                                        data-tooltip-placement="top-left"
                                                        data-tooltip-append-to-body="true"><i
                                                            class="icon icon-information" aria-hidden="true"></i></span>
                                                </label>
                                                <!-- Regex Edit Button -->
                                                <span class="control-label"
                                                    data-uib-tooltip="{{viewWidgetVars.EXCLUDELIST_CONFIG_PAGE_EDIT_REGEX_TOOLTIP}}"
                                                    data-tooltip-placement="top-left" data-tooltip-append-to-body="true"
                                                    data-ng-if="exclusionDetails.isRegexEditable"
                                                    data-ng-click="editIndicatorTypeRegex(indicatorType, exclusionDetails.pattern[0])"><i
                                                        class="icon icon-edit" aria-hidden="true"></i></span>
                                                <label class="control-label text-transform-none pull-right regex-label">
                                                    Regex: {{exclusionDetails.pattern[0] || 'NA'}}
                                                </label>
                                            </div>

                                            <div class="cs-select padding-left-3">
                                                <ui-select name="{{indicatorType}}"
                                                    data-ng-model="exclusionDetails.excludedIOCs" multiple
                                                    class="custom-multi-select" tagging="undefined"
                                                    tagging-label="false"
                                                    data-ng-change="validateIOC($select.selected, indicatorType)"
                                                    data-ng-class="{'has-error': invalidIOCs[indicatorType].length > 0}">
                                                    <ui-select-match
                                                        placeholder="Excluded {{indicatorType}}">{{$item}}</ui-select-match>
                                                    <ui-select-choices repeat="option in initList" refresh-delay="0"
                                                        show="(initList.length > 0)">
                                                        <div ng-bind="option"></div>
                                                    </ui-select-choices>
                                                </ui-select>
                                                <span class="font-075em padding-left-10 text-danger"
                                                    data-ng-if="invalidIOCs[indicatorType].length > 0">Invalid
                                                    {{indicatorType}} -
                                                    <strong>{{invalidIOCs[indicatorType]}}</strong>
                                                </span>
                                                <!-- Edit Regex Div START -->
                                                <div id="edit-indicator-type-regex-container"
                                                    data-ng-if="iocRegexUnderEdit[indicatorType].isEditing"
                                                    class="bulk-import-container-background margin-top-11">
                                                    <label
                                                        class="control-label display-block manual-input-list-container"
                                                        style="padding: 10px 20px;">
                                                        <span class="padding-top-lg font-size-16">Editing
                                                            {{indicatorType}} Regex</span>
                                                    </label>
                                                    <div id="add-indicator-type" class="margin-top-md">
                                                        <div class="add-indicator-type-form">
                                                            <form data-ng-submit="submit()"
                                                                id="submit-indicator-type-form" class="noMargin"
                                                                name="submitIndicatorTypeForm"
                                                                data-ng-class="{'state-wait': processing }">
                                                                <div>
                                                                    <input class="form-control border-radius-5"
                                                                        type="text"
                                                                        ng-model="iocRegexUnderEdit[indicatorType].pattern"
                                                                        name="editRegexPattern"
                                                                        placeholder="{{viewWidgetVars.EXCLUDELIST_CONFIG_PAGE_EDIT_REGEX_ENTER_REGEX_PLACEHOLDER}}"
                                                                        id="editRegexPattern"
                                                                        data-ng-class="{'has-error': isRegexInReview}">
                                                                </div>
                                                            </form>
                                                        </div>
                                                    </div>
                                                    <div class="modal-footer bulk-import-footer">
                                                        <button type="submit" class="btn btn-primary btn-sm"
                                                            id="add-new-ioc-button"
                                                            data-ng-click="saveIOCTypeRegex(indicatorType)">
                                                            <i
                                                                class="icon icon-check margin-right-sm"></i>{{viewWidgetVars.SUBMIT_BUTTON}}
                                                        </button>
                                                        <button type="button" class="btn btn-second-primary btn-sm"
                                                            data-ng-click="resetEditRegexFlags(indicatorType)"
                                                            id="cancel-bulk-import"><i
                                                                class="icon icon-close margin-right-sm"></i>{{viewWidgetVars.CANCEL_BUTTON}}
                                                        </button>
                                                    </div>
                                                </div>
                                                <!-- Edit Regex Div END -->
                                            </div>
                                        </div>
                                    </div>
                                    <!-- UI-SELECT Excluded List Div END -->
                                </div>
                                <!-- Excluded IOCs List Div END -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="ingestion-modal-footer">
                <button type="button" class="btn btn-sm btn-second-primary margin-top-lg margin-left-lg"
                    id="solutionpack-configure-back-env-btn" data-ng-click="moveBack()"><i
                        class="fa fa-chevron-left margin-right-sm"></i>{{viewWidgetVars.BACK_BUTTON}}</button>
                <button type="button" class="btn btn-primary pull-right btn-sm margin-top-lg margin-right-lg"
                    data-ng-click="moveNext('save')" id="solutionpack-configure-env-next-btn"><i
                        class="icon icon-check margin-right-sm"></i>{{viewWidgetVars.SAVE_BUTTON}}
                </button>
                <button type="button" class="btn btn-sm btn-second-primary pull-right margin-top-lg margin-right-lg"
                    data-ng-click="moveNext()" id="solutionpack-configure-env-next-btn">{{viewWidgetVars.SKIP_BUTTON}}<i
                        class="fa fa-chevron-right margin-left-sm"></i>
                </button>
            </div>
        </div>
    </wz-step>
    <wz-step wz-title="{{viewWidgetVars.IOC_TYPE_MAPPING_PAGE_WZ_TITLE}}" wz-order="3" class="ingestion-modal-padding">
        <div class="full-width wz-step-height padding-bottom-md solutionpack-wizard-modal-body">
            <div class="full-height overflow-auto">
                <div class="display-table fixed-table-layout full-height full-width">
                    <div class="full-height display-table-cell vertical-align-middle">
                        <div class="col-md-5 full-height padding-bottom-md"
                            style="padding-left: 5%; padding-top: 200px;">
                            <div class="full-width">
                                <img class="img-responsive d-info-image" src="{{pageImages.fieldMappingPageImage}}">
                            </div>
                        </div>
                        <div class="col-md-7 config-section">
                            <div class="padding-20">
                                <div class="font-size-25 display-inline-flex">
                                    <div id="fieldMappingTitle" class="margin-right-md">
                                        {{viewWidgetVars.IOC_TYPE_MAPPING_PAGE_TITLE}}
                                    </div>
                                    <div id="module-selection">
                                        <select name="select-module" id="select-module"
                                            class="form-control border-radius-5" data-ng-model="selectedModule"
                                            data-ng-change="getSelectedModuleFields(selectedModule)"
                                            style="width: auto;">
                                            <option ng-repeat="item in moduleList" value="{{item}}"
                                                data-ng-selected="item === selectedModule">{{item}}</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="padding-right-30 margin-top-sm max-width-450px">
                                    <p class="font-size-14 grey-text margin-bottom-0 z-index-0">
                                        {{viewWidgetVars.IOC_TYPE_MAPPING_PAGE_DESCRIPTION}}</p>
                                </div><br />

                                <!-- Field Type Mapping Div START -->
                                <div id="indicator-type-mapping-container" class="field-mapping-container">

                                    <!-- Search Bar START -->
                                    <div id="field-search-bar" class="display-flex">
                                        <div class="field-mapping-heading-bgcolor width-65">
                                            <div
                                                class="margin-bottom-xlg margin-left-30 margin-top-md position-relative width-65 filterSearch">
                                                <label
                                                    class="control-label font-primary-color">{{viewWidgetVars.IOC_TYPE_MAPPING_PAGE_FIELD_COLUMN_TITLE}}</label>
                                                <span
                                                    class="font-075em icon icon-search margin-left-md position-absolute right-10 top-breadcrumb"
                                                    data-ng-click="" style="top: 37px;"></span>
                                                <input id="search-by-field" type="text"
                                                    class="form-control padding-right-30"
                                                    placeholder="{{viewWidgetVars.IOC_TYPE_MAPPING_PAGE_FIELD_COLUMN_PLACEHOLDER}}"
                                                    aria-labelledby="search-btn"
                                                    data-ng-model="searchParam.searchByTitle" aria-invalid="false"
                                                    style="font-size: 12px;">
                                            </div>
                                        </div>
                                        <div class="field-mapping-heading-bgcolor width-35">
                                            <div
                                                class="margin-bottom-xlg margin-left-30 margin-top-md position-relative width-65 filterSearch">
                                                <label
                                                    class="control-label font-primary-color">{{viewWidgetVars.IOC_TYPE_MAPPING_PAGE_TYPE_COLUMN_TITLE}}</label>
                                                <span
                                                    class="font-075em icon icon-filter margin-left-md position-absolute right-10 top-breadcrumb"
                                                    data-ng-click="" style="top: 37px;"></span>
                                                <input id="search-by-field" type="text"
                                                    class="form-control padding-right-30 font-size-12"
                                                    placeholder="{{viewWidgetVars.IOC_TYPE_MAPPING_PAGE_TYPE_COLUMN_PLACEHOLDER}}"
                                                    aria-labelledby="search-btn"
                                                    data-ng-model="searchParam.searchByIocType" aria-invalid="false">
                                            </div>
                                        </div>
                                    </div>
                                    <!-- Search Bar END -->

                                    <!-- Field Mapping List START -->
                                    <div id="indicator-type-list" class="display-flex"
                                        data-ng-repeat="fieldInfo in sortedFieldTypes | filter: fieldMappingSearchFilter">
                                        <div class="width-65 field-mapping-rows-bgcolor">
                                            <div class="margin-left-30 margin-top-md position-relative width-65">
                                                <label class="control-label"
                                                    style="font-size: 13px; margin-top: 10px;">{{fieldInfo[1].title}}</label>
                                            </div>
                                        </div>
                                        <div class="width-35 field-mapping-rows-bgcolor">
                                            <div
                                                class="margin-bottom-md margin-left-30 margin-top-md position-relative width-65">
                                                <select name="indicator-type-picklist" id="indicator-type-picklist"
                                                    class="form-control border-radius-5 font-size-12"
                                                    data-ng-model="fieldInfo[1].iocType"
                                                    data-ng-change="fieldIndicatorTypeChanged(fieldInfo[0], fieldInfo[1].iocType, 'fieldMappingUpdate')">
                                                    <option
                                                        value="{{viewWidgetVars.IOC_TYPE_MAPPING_PAGE_NOT_SET_LIST_ITEM}}"
                                                        selected>
                                                        {{viewWidgetVars.IOC_TYPE_MAPPING_PAGE_NOT_SET_LIST_ITEM}}
                                                    </option>
                                                    <option ng-repeat="item in iocTypePicklistItems" value="{{item}}"
                                                        data-ng-selected="item === fieldInfo[1].iocType">{{item}}
                                                    </option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- Field Mapping List END -->
                                </div>
                                <!-- Field Type Mapping Div END -->

                                <!-- File Type Setting Div START -->
                                <div id="file-type-indicator-setting">
                                    <label class="control-label font-primary-color">
                                        {{viewWidgetVars.IOC_TYPE_MAPPING_PAGE_FILETYPE_IOC_SETTING_LABEL}}
                                    </label>


                                    <div class="field-mapping-checkbox">
                                        <input type="checkbox" class="margin-right-md pull-left"
                                            name="select-create-file-iocs" id="select-create-file-iocs"
                                            data-ng-model="updatedIOCTypeFieldMapping.recordValue.createFileIOCs"
                                            data-ng-change="fieldIndicatorTypeChanged('createFileIOCs', updatedIOCTypeFieldMapping.recordValue.createFileIOCs, 'fieldFlagsUpdate')">
                                        </input>
                                        <label for="select-create-file-iocs"
                                            class="control-label font-size-12 margin-top-2 pull-left">{{viewWidgetVars.IOC_TYPE_MAPPING_PAGE_ENABLE_CREATE_FILE_INDICATOR}}
                                            <span
                                                data-uib-tooltip="{{viewWidgetVars.IOC_TYPE_MAPPING_PAGE_ENABLE_CREATE_FILE_INDICATOR_TOOLTIP}}"
                                                data-tooltip-placement="top-left" data-tooltip-append-to-body="true"><i
                                                    class="icon icon-information" aria-hidden="true"></i>
                                            </span>
                                        </label>
                                    </div>

                                    <div class="field-mapping-checkbox">
                                        <input type="checkbox" class="margin-right-md pull-left"
                                            name="select-add-excluded-file-comment"
                                            id="select-add-excluded-file-comment"
                                            data-ng-model="updatedIOCTypeFieldMapping.recordValue.addExcludedFileComment"
                                            data-ng-change="fieldIndicatorTypeChanged('addExcludedFileComment', updatedIOCTypeFieldMapping.recordValue.addExcludedFileComment, 'fieldFlagsUpdate')">
                                        </input>
                                        <label for="select-add-excluded-file-comment"
                                            class="control-label font-size-12 margin-top-2 pull-left">{{viewWidgetVars.IOC_TYPE_MAPPING_PAGE_ENABLE_ADD_COMMENT_FOR_EXCLUDED_FILES}}
                                            <span
                                                data-uib-tooltip="{{viewWidgetVars.IOC_TYPE_MAPPING_PAGE_ENABLE_ADD_COMMENT_FOR_EXCLUDED_FILES_TOOLTIP}}"
                                                data-tooltip-placement="top-left" data-tooltip-append-to-body="true"><i
                                                    class="icon icon-information" aria-hidden="true"></i>
                                            </span>
                                        </label>
                                    </div>

                                </div>
                                <!-- File Type Setting Div END -->

                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="ingestion-modal-footer">
                <button type="button" class="btn btn-sm btn-second-primary margin-top-lg margin-left-lg"
                    id="solutionpack-configure-back-env-btn" data-ng-click="moveBack()"><i
                        class="fa fa-chevron-left margin-right-sm"></i>{{viewWidgetVars.BACK_BUTTON}}</button>
                <button type="button" class="btn btn-primary pull-right btn-sm margin-top-lg margin-right-lg"
                    data-ng-click="moveNext('save')" id="solutionpack-configure-env-next-btn"><i
                        class="icon icon-check margin-right-sm"></i>{{viewWidgetVars.SAVE_BUTTON}}
                </button>
                <button type="button" class="btn btn-sm btn-second-primary pull-right margin-top-lg margin-right-lg"
                    data-ng-click="moveNext()" id="solutionpack-configure-env-next-btn">{{viewWidgetVars.SKIP_BUTTON}}<i
                        class="fa fa-chevron-right margin-left-sm"></i>
                </button>
            </div>
        </div>
    </wz-step>
    <wz-step wz-title="{{viewWidgetVars.FINISH_PAGE_WZ_TITLE}}" wz-order="4" class="ingestion-modal-padding">
        <div class="full-width wz-step-height padding-bottom-md solutionpack-wizard-modal-body">
            <div class="full-height">
                <div class="display-table fixed-table-layout full-height full-width">
                    <div class="full-height display-table-cell vertical-align-middle">
                        <div class="col-md-5 full-height padding-bottom-md">
                            <div class="full-width">
                                <img class="d-info-image img-responsive padding-left-20-per padding-top-35-per"
                                    src="{{pageImages.finishPageImage}}">
                            </div>
                        </div>
                        <div class="col-md-7 config-section">
                            <div class="padding-20">
                                <div class="margin-top-10per">
                                    <div class="font-size-25">{{viewWidgetVars.FINISH_PAGE_TITLE}}
                                    </div>
                                    <div class="padding-right-30 margin-top-sm max-width-450px">
                                        <p class="font-size-14 grey-text margin-bottom-0 z-index-0">
                                            {{viewWidgetVars.FINISH_PAGE_DESCRIPTION}}
                                        </p>
                                    </div>
                                </div>
                                <div class="margin-top-20">
                                    <div class="font-size-16">
                                        {{viewWidgetVars.FINISH_PAGE_EXCLUSION_SETTING_SUMMARY_HEADING}}
                                    </div>
                                    <div data-ng-if="isExclusionSettingChanged">
                                        <ul>
                                            <li data-ng-repeat="item in summary.exclusionSettingSummary">
                                                <span class="control-label grey-text">{{item}}</span>
                                            </li>
                                        </ul>
                                    </div>
                                    <div data-ng-if="!isExclusionSettingChanged">
                                        <ul>
                                            <li>
                                                <span
                                                    class="control-label grey-text">{{viewWidgetVars.FINISH_PAGE_NO_EXCLUSION_CHANGE_MESSAGE}}</span>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="margin-top-20">
                                    <div class="font-size-16">
                                        {{viewWidgetVars.FINISH_PAGE_FIELD_MAPPING_SUMMARY_HEADING}}
                                    </div>
                                    <div>
                                        <ul>
                                            <li data-ng-repeat="item in summary.fieldMappingSummary">
                                                <span class="control-label grey-text">{{item}}</span>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="ingestion-modal-footer">
                <button type="button" class="btn btn-sm btn-second-primary margin-top-lg margin-left-lg"
                    id="solutionpack-configure-back-env-btn" data-ng-click="moveBack()"><i
                        class="fa fa-chevron-left margin-right-sm"></i>{{viewWidgetVars.BACK_BUTTON}}</button>
                <button type="button" class="btn btn-primary pull-right btn-sm margin-top-lg margin-right-lg"
                    data-ng-click="moveNext()"
                    id="solutionpack-configure-env-next-btn">{{viewWidgetVars.FINISH_BUTTON}}<i
                        class="fa fa-chevron-right margin-left-sm"></i>
                </button>
            </div>
        </div>
    </wz-step>
</wizard>